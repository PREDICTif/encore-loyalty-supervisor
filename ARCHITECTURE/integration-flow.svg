<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 800">
  <!-- Title -->
  <text x="600" y="30" font-family="Arial, sans-serif" font-size="24" font-weight="bold" text-anchor="middle">
    Encore-Loyalty AI Feedback Integration Flow
  </text>

  <!-- Encore-Loyalty System Box -->
  <g id="encore-loyalty">
    <rect x="50" y="60" width="500" height="300" fill="#E3F2FD" stroke="#1976D2" stroke-width="2" rx="10"/>
    <text x="300" y="90" font-family="Arial, sans-serif" font-size="18" font-weight="bold" text-anchor="middle">
      Encore-Loyalty Main System (PHP)
    </text>

    <!-- Components -->
    <rect x="70" y="120" width="140" height="50" fill="#BBDEFB" stroke="#1976D2" rx="5"/>
    <text x="140" y="150" font-family="Arial, sans-serif" font-size="14" text-anchor="middle">Global Admin</text>

    <rect x="220" y="120" width="140" height="50" fill="#BBDEFB" stroke="#1976D2" rx="5"/>
    <text x="290" y="150" font-family="Arial, sans-serif" font-size="14" text-anchor="middle">Venue Admin</text>

    <rect x="370" y="120" width="160" height="50" fill="#BBDEFB" stroke="#1976D2" rx="5"/>
    <text x="450" y="150" font-family="Arial, sans-serif" font-size="14" text-anchor="middle">Feedback Module</text>

    <!-- Database -->
    <ellipse cx="200" cy="250" rx="80" ry="40" fill="#FFF3E0" stroke="#F57C00"/>
    <text x="200" y="255" font-family="Arial, sans-serif" font-size="14" text-anchor="middle">MySQL DB</text>

    <!-- Cron -->
    <rect x="320" y="220" width="120" height="60" fill="#E8F5E9" stroke="#388E3C" rx="5"/>
    <text x="380" y="245" font-family="Arial, sans-serif" font-size="14" text-anchor="middle">Cron Jobs</text>
    <text x="380" y="265" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">(Polling)</text>
  </g>

  <!-- AI Backend System Box -->
  <g id="ai-backend">
    <rect x="650" y="60" width="500" height="300" fill="#E8F5E9" stroke="#388E3C" stroke-width="2" rx="10"/>
    <text x="900" y="90" font-family="Arial, sans-serif" font-size="18" font-weight="bold" text-anchor="middle">
      AI Backend System (FastAPI)
    </text>

    <!-- API Layer -->
    <rect x="670" y="120" width="460" height="50" fill="#C8E6C9" stroke="#388E3C" rx="5"/>
    <text x="900" y="150" font-family="Arial, sans-serif" font-size="14" text-anchor="middle">API Gateway / Endpoints</text>

    <!-- Services -->
    <rect x="670" y="190" width="140" height="50" fill="#A5D6A7" stroke="#388E3C" rx="5"/>
    <text x="740" y="220" font-family="Arial, sans-serif" font-size="14" text-anchor="middle">AI Service</text>

    <rect x="820" y="190" width="140" height="50" fill="#A5D6A7" stroke="#388E3C" rx="5"/>
    <text x="890" y="220" font-family="Arial, sans-serif" font-size="14" text-anchor="middle">Email Service</text>

    <rect x="970" y="190" width="150" height="50" fill="#A5D6A7" stroke="#388E3C" rx="5"/>
    <text x="1045" y="220" font-family="Arial, sans-serif" font-size="14" text-anchor="middle">Background Jobs</text>
  </g>

  <!-- Cloud Storage -->
  <g id="cloud-storage">
    <rect x="650" y="400" width="500" height="120" fill="#F3E5F5" stroke="#7B1FA2" stroke-width="2" rx="10"/>
    <text x="900" y="430" font-family="Arial, sans-serif" font-size="18" font-weight="bold" text-anchor="middle">
      Cloud Storage (AWS)
    </text>

    <ellipse cx="750" cy="470" rx="70" ry="30" fill="#E1BEE7" stroke="#7B1FA2"/>
    <text x="750" y="475" font-family="Arial, sans-serif" font-size="14" text-anchor="middle">DynamoDB</text>

    <ellipse cx="900" cy="470" rx="70" ry="30" fill="#E1BEE7" stroke="#7B1FA2"/>
    <text x="900" y="475" font-family="Arial, sans-serif" font-size="14" text-anchor="middle">S3 Bucket</text>

    <ellipse cx="1050" cy="470" rx="70" ry="30" fill="#E1BEE7" stroke="#7B1FA2"/>
    <text x="1050" y="475" font-family="Arial, sans-serif" font-size="14" text-anchor="middle">CloudWatch</text>
  </g>

  <!-- UI Components -->
  <g id="ui-components">
    <rect x="50" y="400" width="500" height="120" fill="#FCE4EC" stroke="#C2185B" stroke-width="2" rx="10"/>
    <text x="300" y="430" font-family="Arial, sans-serif" font-size="18" font-weight="bold" text-anchor="middle">
      React UI Components
    </text>

    <rect x="70" y="460" width="140" height="40" fill="#F8BBD0" stroke="#C2185B" rx="5"/>
    <text x="140" y="485" font-family="Arial, sans-serif" font-size="14" text-anchor="middle">Settings Popup</text>

    <rect x="220" y="460" width="150" height="40" fill="#F8BBD0" stroke="#C2185B" rx="5"/>
    <text x="295" y="485" font-family="Arial, sans-serif" font-size="14" text-anchor="middle">Response Editor</text>

    <rect x="380" y="460" width="150" height="40" fill="#F8BBD0" stroke="#C2185B" rx="5"/>
    <text x="455" y="485" font-family="Arial, sans-serif" font-size="14" text-anchor="middle">Dashboard Widget</text>
  </g>

  <!-- Arrows -->
  <!-- Encore to API -->
  <path d="M 550 190 L 650 190" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
  <text x="600" y="180" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">API Calls</text>

  <!-- Cron to MySQL -->
  <path d="M 320 250 L 280 250" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>

  <!-- Cron to API -->
  <path d="M 440 250 L 650 250" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
  <text x="545" y="240" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">Poll and Send</text>

  <!-- API to Cloud -->
  <path d="M 900 360 L 900 400" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>

  <!-- UI to Encore -->
  <path d="M 300 400 L 300 360" stroke="#333" stroke-width="2" stroke-dasharray="5,5"/>
  <text x="320" y="380" font-family="Arial, sans-serif" font-size="12">iframe/modal</text>

  <!-- UI to API -->
  <path d="M 550 480 L 650 350" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>

  <!-- Arrow marker definition -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#333"/>
    </marker>
  </defs>

  <!-- Process Flow Numbers -->
  <g id="flow-numbers">
    <circle cx="140" cy="200" r="15" fill="#FF5722" opacity="0.8"/>
    <text x="140" y="205" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white" text-anchor="middle">1</text>

    <circle cx="380" cy="300" r="15" fill="#FF5722" opacity="0.8"/>
    <text x="380" y="305" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white" text-anchor="middle">2</text>

    <circle cx="740" cy="270" r="15" fill="#FF5722" opacity="0.8"/>
    <text x="740" y="275" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white" text-anchor="middle">3</text>

    <circle cx="900" cy="380" r="15" fill="#FF5722" opacity="0.8"/>
    <text x="900" y="385" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white" text-anchor="middle">4</text>
  </g>

  <!-- Legend -->
  <g id="legend">
    <rect x="50" y="560" width="1100" height="220" fill="#FAFAFA" stroke="#999" stroke-width="1" rx="5"/>
    <text x="600" y="590" font-family="Arial, sans-serif" font-size="16" font-weight="bold" text-anchor="middle">
      Integration Flow Steps
    </text>

    <circle cx="80" cy="620" r="12" fill="#FF5722"/>
    <text x="75" y="625" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white" text-anchor="middle">1</text>
    <text x="110" y="625" font-family="Arial, sans-serif" font-size="14">Admin enables AI for venue → API provisioning call</text>

    <circle cx="80" cy="660" r="12" fill="#FF5722"/>
    <text x="75" y="665" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white" text-anchor="middle">2</text>
    <text x="110" y="665" font-family="Arial, sans-serif" font-size="14">Cron job polls for new feedback → Sends to AI backend</text>

    <circle cx="80" cy="700" r="12" fill="#FF5722"/>
    <text x="75" y="705" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white" text-anchor="middle">3</text>
    <text x="110" y="705" font-family="Arial, sans-serif" font-size="14">AI analyzes feedback → Generates response → Sends alerts</text>

    <circle cx="80" cy="740" r="12" fill="#FF5722"/>
    <text x="75" y="745" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white" text-anchor="middle">4</text>
    <text x="110" y="745" font-family="Arial, sans-serif" font-size="14">Store in cloud → Sync back to Encore-Loyalty → Display to venue admin</text>
  </g>
</svg>
